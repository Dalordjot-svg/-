<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>8–í ‚Ä¢ II —Å–º–µ–Ω–∞</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
</head>
<body>
  <header>
    <h1>8–í ‚Ä¢ II —Å–º–µ–Ω–∞</h1>
    <p id="dayText">–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–Ω—è...</p>
  </header>

  <!-- === –£–í–ï–î–û–ú–õ–ï–ù–ò–ï –û–ë –û–ë–ù–û–í–õ–ï–ù–ò–ò === -->
  <div id="updateModal" class="modal hidden">
    <div class="modal-content">
      <h2>üîî –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∞–π—Ç–∞</h2>
      <p>–í —ç—Ç–æ–π –≤–µ—Ä—Å–∏–∏ –±—ã–ª–∏ –≤–Ω–µ–¥—Ä–µ–Ω—ã —É–ª—É—á—à–µ–Ω–∏—è:</p>
      <ul>
        <li>üéâ –î–æ–±–∞–≤–ª–µ–Ω–æ –∫–æ–Ω—Ñ–µ—Ç—Ç–∏ –∏ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —É—Ä–æ–∫–æ–≤</li>
        <li>‚ö° –£—Å–∫–æ—Ä–µ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è</li>
        <li>üì± –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–¥ —Ç–µ–ª–µ—Ñ–æ–Ω—ã</li>
        <li>‚ú® –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –º–µ–ª–∫–∏–µ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –±–∞–≥–∏</li>
      </ul>
      <button id="okUpdate">–û–ö</button>
    </div>
  </div>

  <main>
    <section id="mainSection">
      <table>
        <thead>
          <tr>
            <th>‚Ññ</th>
            <th>–í—Ä–µ–º—è</th>
            <th>–ü—Ä–µ–¥–º–µ—Ç</th>
            <th>–ö–∞–±.</th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>

      <div class="timer-block">
        <div class="timer">
          <svg width="140" height="140">
            <defs>
              <linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#3b82f6" />
                <stop offset="100%" stop-color="#10b981" />
              </linearGradient>
            </defs>
            <circle class="bg" cx="70" cy="70" r="60"></circle>
            <circle class="fg" id="progress" cx="70" cy="70" r="60"></circle>
          </svg>
          <div class="time" id="timeDisplay">00:00</div>
        </div>
        <div class="status" id="status">‚Äî</div>
      </div>

      <button class="main-btn" id="toSchedule">üìÖ –í—Å—ë —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</button>
    </section>

    <!-- === –ü–û–ó–î–†–ê–í–õ–ï–ù–ò–ï –ü–û–°–õ–ï –£–†–û–ö–û–í === -->
    <div id="endMessage" class="hidden">
      <h2>üéâ –£—Ä–æ–∫–∏ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å! üéâ</h2>
      <p>–ú–æ–∂–Ω–æ —Å–ø–æ–∫–æ–π–Ω–æ –æ—Ç–¥—ã—Ö–∞—Ç—å üòé</p>
    </div>
  </main>

  <footer>
    ¬© 8–í –∫–ª–∞—Å—Å ‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É—Ä–æ–∫–∞ –∏ –¥–Ω—è
  </footer>

  <script src="script.js"></script>
  <script>
    // === –û–î–ù–û–†–ê–ó–û–í–û–ï –£–í–ï–î–û–ú–õ–ï–ù–ò–ï –û–ë –û–ë–ù–û–í–õ–ï–ù–ò–ò ===
    const modal = document.getElementById("updateModal");
    const okBtn = document.getElementById("okUpdate");

    if (!localStorage.getItem("update_v2_ack")) {
      modal.classList.remove("hidden");
    }

    okBtn.addEventListener("click", () => {
      localStorage.setItem("update_v2_ack", "true");
      modal.classList.add("hidden");
    });

    // === –ü–ï–†–ï–•–û–î –ö–û –í–°–ï–ú–£ –†–ê–°–ü–ò–°–ê–ù–ò–Æ ===
    document.getElementById("toSchedule").addEventListener("click", () => {
      window.location.href = "schedule.html";
    });

    // === –ö–û–ù–§–ï–¢–¢–ò ===
    function showConfetti() {
      const duration = 4 * 1000;
      const end = Date.now() + duration;

      (function frame() {
        confetti({
          particleCount: 4,
          startVelocity: 30,
          spread: 360,
          ticks: 60,
          origin: { x: Math.random(), y: Math.random() - 0.2 }
        });
        if (Date.now() < end) requestAnimationFrame(frame);
      })();
    }

    // === –û–ë–†–ê–ë–û–¢–ö–ê –ö–û–ù–¶–ê –£–†–û–ö–û–í ===
    const observer = new MutationObserver(() => {
      const status = document.getElementById("status").textContent;
      const endMessage = document.getElementById("endMessage");
      if (status.includes("–∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å")) {
        endMessage.classList.remove("hidden");
        showConfetti();
      } else {
        endMessage.classList.add("hidden");
      }
    });
    observer.observe(document.getElementById("status"), { childList: true });
  </script>
</body>
</html>
